 R←Test_Attachments_001(stopFlag batchFlag);⎕IO;⎕ML;⎕TRAP;mat
⍝ Check the Attachment.GetMimeTypes function
 ⎕IO←1 ⋄ ⎕ML←1
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←T._Failed

 mat←##.Attachment.GetMimeTypes''
 →T.PassesIf 2=2⊃⍴mat
 →T.PassesIf 0<≢mat
 →T.PassesIf(,'.')≡∪⊃¨mat[;1]
 →T.PassesIf~∨/∨/¨mat[;2]∊¨⊂⎕UCS 9 32 ⍝ tab and space

 →T.PassesIf 0=≢##.Attachment.GetMimeTypes'Does-not-exist-for-sure'
 →T.PassesIf'text/plain'≡##.Attachment.GetMimeTypes'.txt'
 →T.PassesIf'application/pdf'≡##.Attachment.GetMimeTypes'pdf'
 →T.PassesIf'application/msword'≡##.Attachment.GetMimeTypes'.DOC'

 R←T._OK
⍝Done
